# ğŸ’¾ 10.5 ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ ê³„íš

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#1-ê°œìš”)
2. [ì‚¬ìš©ìë³„ ì €ì¥ ìš©ëŸ‰ ê³„ì‚°](#2-ì‚¬ìš©ìë³„-ì €ì¥-ìš©ëŸ‰-ê³„ì‚°)
3. [ì „ì²´ ìš©ëŸ‰ ì˜ˆì¸¡](#3-ì „ì²´-ìš©ëŸ‰-ì˜ˆì¸¡)
4. [ë¹„ìš© ê³„íš](#4-ë¹„ìš©-ê³„íš)
5. [ë³´ê´€ ì •ì±…](#5-ë³´ê´€-ì •ì±…)

## 1. ê°œìš”

Fallingo ì„œë¹„ìŠ¤ì˜ ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ë¹„ìš©ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.

### ğŸ“Œ í•µì‹¬ í¬ì¸íŠ¸
- âœ… ì‚¬ìš©ìë‹¹ í‰ê·  2GB ì €ì¥ ê³µê°„ ì˜ˆìƒ
- âœ… ì´ë¯¸ì§€ ì••ì¶•ìœ¼ë¡œ 80% ìš©ëŸ‰ ì ˆê°
- âœ… ë‹¨ê³„ë³„ ë³´ê´€ ì •ì±…ìœ¼ë¡œ ë¹„ìš© ìµœì í™”

## 2. ì‚¬ìš©ìë³„ ì €ì¥ ìš©ëŸ‰ ê³„ì‚°

### [í•„ìˆ˜] ê¸°ë³¸ ê°€ì •
```yaml
# íŒŒì¼: config/storage_assumptions.yaml
user_behavior:
  # í™œë™ ìˆ˜ì¤€ë³„ ì‚¬ìš©ì ë¹„ìœ¨
  active_users: 20%      # ì£¼ 3íšŒ ì´ìƒ ë“±ë¡
  regular_users: 30%     # ì£¼ 1íšŒ ì •ë„ ë“±ë¡  
  casual_users: 50%      # ì›” 1-2íšŒ ë“±ë¡

post_metrics:
  average_photos_per_post: 3        # ê²Œì‹œë¬¼ë‹¹ í‰ê·  ì‚¬ì§„ ìˆ˜
  average_original_size: 4MB        # ì›ë³¸ ì‚¬ì§„ í‰ê·  í¬ê¸°
  compressed_size: 800KB            # ì••ì¶• í›„ í¬ê¸° (80% ì••ì¶•)
  thumbnail_size: 50KB              # ì¸ë„¤ì¼ í¬ê¸°
  
activity_rates:
  active_user_posts_per_month: 12   # í™œë°œí•œ ì‚¬ìš©ì
  regular_user_posts_per_month: 4   # ì¼ë°˜ ì‚¬ìš©ì
  casual_user_posts_per_month: 1.5  # ê°€ë” ì‚¬ìš©ì
```

### [í•„ìˆ˜] ì‚¬ìš©ìë‹¹ ì›”ê°„ ìš©ëŸ‰ ê³„ì‚°
```python
# íŒŒì¼: backend/utils/storage_calculator.py
class StorageCalculator:
    def calculate_monthly_storage_per_user(self):
        """ì‚¬ìš©ìë‹¹ ì›”ê°„ í‰ê·  ì €ì¥ ìš©ëŸ‰ ê³„ì‚°"""
        
        # ì´ë¯¸ì§€ í¬ê¸° (ì••ì¶• + ì¸ë„¤ì¼)
        image_size_per_photo = 800 + 50  # KB
        photos_per_post = 3
        
        # ì‚¬ìš©ì ìœ í˜•ë³„ ì›”ê°„ ìš©ëŸ‰
        active_storage = (
            12 * photos_per_post * image_size_per_photo * 0.2
        )  # 7,200 KB
        
        regular_storage = (
            4 * photos_per_post * image_size_per_photo * 0.3
        )  # 3,060 KB
        
        casual_storage = (
            1.5 * photos_per_post * image_size_per_photo * 0.5
        )  # 1,912 KB
        
        # í‰ê·  ì›”ê°„ ìš©ëŸ‰ (KB)
        avg_monthly = active_storage + regular_storage + casual_storage
        # 12,172 KB â‰ˆ 12 MB/ì›”
        
        return {
            "monthly_mb": round(avg_monthly / 1024, 1),
            "yearly_mb": round(avg_monthly * 12 / 1024, 1),
            "yearly_gb": round(avg_monthly * 12 / 1024 / 1024, 2)
        }
```

### [í•„ìˆ˜] ëˆ„ì  ìš©ëŸ‰ ì˜ˆì¸¡
```python
# íŒŒì¼: backend/utils/storage_projection.py
def project_user_storage(months=12):
    """ê°œë³„ ì‚¬ìš©ìì˜ ëˆ„ì  ì €ì¥ ìš©ëŸ‰ ì˜ˆì¸¡"""
    
    monthly_mb = 12  # ì›” í‰ê·  12MB
    retention_factor = 0.95  # 5% ì‚­ì œìœ¨ ë°˜ì˜
    
    projections = []
    cumulative = 0
    
    for month in range(1, months + 1):
        monthly_data = monthly_mb * retention_factor
        cumulative += monthly_data
        
        projections.append({
            "month": month,
            "monthly_mb": round(monthly_data, 1),
            "cumulative_mb": round(cumulative, 1),
            "cumulative_gb": round(cumulative / 1024, 2)
        })
    
    return projections
```

## 3. ì „ì²´ ìš©ëŸ‰ ì˜ˆì¸¡

### [í•„ìˆ˜] ì„œë¹„ìŠ¤ ì„±ì¥ ì‹œë‚˜ë¦¬ì˜¤
```python
# íŒŒì¼: backend/utils/service_growth.py
GROWTH_SCENARIOS = {
    "conservative": {
        "year_1": 50000,      # 5ë§Œ ëª…
        "year_2": 200000,     # 20ë§Œ ëª…
        "year_3": 500000,     # 50ë§Œ ëª…
        "growth_rate": 0.15   # ì›” 15% ì„±ì¥
    },
    "moderate": {
        "year_1": 100000,     # 10ë§Œ ëª…
        "year_2": 500000,     # 50ë§Œ ëª…
        "year_3": 1500000,    # 150ë§Œ ëª…
        "growth_rate": 0.25   # ì›” 25% ì„±ì¥
    },
    "aggressive": {
        "year_1": 200000,     # 20ë§Œ ëª…
        "year_2": 1000000,    # 100ë§Œ ëª…
        "year_3": 3000000,    # 300ë§Œ ëª…
        "growth_rate": 0.35   # ì›” 35% ì„±ì¥
    }
}

def calculate_total_storage(scenario="moderate"):
    """ì „ì²´ ì„œë¹„ìŠ¤ ì €ì¥ ìš©ëŸ‰ ê³„ì‚°"""
    
    growth = GROWTH_SCENARIOS[scenario]
    user_yearly_gb = 0.14  # ì‚¬ìš©ìë‹¹ ì—°ê°„ 0.14GB
    
    # 3ë…„ê°„ ëˆ„ì  ìš©ëŸ‰ ê³„ì‚°
    year_1_storage = growth["year_1"] * user_yearly_gb * 0.5  # ë°˜ë…„ í‰ê· 
    year_2_storage = growth["year_2"] * user_yearly_gb
    year_3_storage = growth["year_3"] * user_yearly_gb
    
    total_tb = (year_1_storage + year_2_storage + year_3_storage) / 1024
    
    return {
        "scenario": scenario,
        "year_1_tb": round(year_1_storage / 1024, 2),
        "year_2_tb": round(year_2_storage / 1024, 2),
        "year_3_tb": round(year_3_storage / 1024, 2),
        "total_3year_tb": round(total_tb, 2)
    }
```

### [í•„ìˆ˜] ì €ì¥ì†Œ íƒ€ì…ë³„ ë¶„ë°°
```yaml
# íŒŒì¼: config/storage_distribution.yaml
storage_tiers:
  hot_storage:  # ìì£¼ ì ‘ê·¼í•˜ëŠ” ìµœê·¼ ë°ì´í„°
    percentage: 20%
    description: "ìµœê·¼ 3ê°œì›” ë°ì´í„°"
    storage_class: "Supabase Storage (Standard)"
    
  warm_storage:  # ê°€ë” ì ‘ê·¼í•˜ëŠ” ë°ì´í„°
    percentage: 30%
    description: "3ê°œì›”-1ë…„ ë°ì´í„°"
    storage_class: "Supabase Storage (Infrequent Access)"
    
  cold_storage:  # ê±°ì˜ ì ‘ê·¼í•˜ì§€ ì•ŠëŠ” ë°ì´í„°
    percentage: 50%
    description: "1ë…„ ì´ìƒ ë°ì´í„°"
    storage_class: "External Archive (S3 Glacier)"
```

## 4. ë¹„ìš© ê³„íš

### [í•„ìˆ˜] Supabase Storage ë¹„ìš© ê³„ì‚°
```python
# íŒŒì¼: backend/utils/cost_calculator.py
class StorageCostCalculator:
    # Supabase ê°€ê²© (2024ë…„ ê¸°ì¤€)
    PRICING = {
        "storage_per_gb_month": 0.021,     # $0.021/GB/ì›”
        "bandwidth_per_gb": 0.09,          # $0.09/GB ì „ì†¡
        "free_tier": {
            "storage_gb": 1,               # 1GB ë¬´ë£Œ
            "bandwidth_gb": 2               # 2GB ì „ì†¡ ë¬´ë£Œ
        }
    }
    
    def calculate_monthly_cost(self, total_users, avg_gb_per_user):
        """ì›”ê°„ ìŠ¤í† ë¦¬ì§€ ë¹„ìš© ê³„ì‚°"""
        
        # ì´ ì €ì¥ ìš©ëŸ‰
        total_storage_gb = total_users * avg_gb_per_user
        billable_storage = max(0, total_storage_gb - self.PRICING["free_tier"]["storage_gb"])
        
        # ì˜ˆìƒ ëŒ€ì—­í­ (ì €ì¥ ìš©ëŸ‰ì˜ 3ë°° ê°€ì •)
        monthly_bandwidth = total_storage_gb * 3
        billable_bandwidth = max(0, monthly_bandwidth - self.PRICING["free_tier"]["bandwidth_gb"])
        
        # ë¹„ìš© ê³„ì‚°
        storage_cost = billable_storage * self.PRICING["storage_per_gb_month"]
        bandwidth_cost = billable_bandwidth * self.PRICING["bandwidth_per_gb"]
        
        return {
            "storage_gb": round(total_storage_gb, 2),
            "storage_cost_usd": round(storage_cost, 2),
            "bandwidth_gb": round(monthly_bandwidth, 2),
            "bandwidth_cost_usd": round(bandwidth_cost, 2),
            "total_cost_usd": round(storage_cost + bandwidth_cost, 2),
            "total_cost_krw": round((storage_cost + bandwidth_cost) * 1300, 0)
        }
```

### [í•„ìˆ˜] ë¹„ìš© ìµœì í™” ì „ëµ
```python
# íŒŒì¼: backend/utils/cost_optimization.py
OPTIMIZATION_STRATEGIES = {
    "image_compression": {
        "savings": "80%",
        "implementation": "WebP í¬ë§· + ì ì‘í˜• í’ˆì§ˆ",
        "estimated_savings_per_tb": 800  # $800/TB
    },
    "lazy_loading": {
        "savings": "30%",
        "implementation": "í•„ìš”ì‹œì—ë§Œ ì›ë³¸ ë¡œë“œ",
        "bandwidth_reduction": "30%"
    },
    "cdn_caching": {
        "savings": "50%",
        "implementation": "CloudFlare CDN í™œìš©",
        "bandwidth_reduction": "50%"
    },
    "tiered_storage": {
        "savings": "40%",
        "implementation": "ì˜¤ë˜ëœ ë°ì´í„° ì•„ì¹´ì´ë¸Œ",
        "cost_reduction": "40%"
    }
}
```

## 5. ë³´ê´€ ì •ì±…

### [í•„ìˆ˜] ë°ì´í„° ìˆ˜ëª… ì£¼ê¸°
```yaml
# íŒŒì¼: config/retention_policy.yaml
retention_policy:
  active_period:
    duration: 3_months
    storage_tier: "hot"
    compression: "lossless"
    access_pattern: "frequent"
    
  archive_period:
    duration: 12_months
    storage_tier: "warm"
    compression: "lossy_85_quality"
    access_pattern: "infrequent"
    
  long_term_archive:
    duration: 36_months
    storage_tier: "cold"
    compression: "lossy_70_quality"
    access_pattern: "rare"
    
  deletion_policy:
    inactive_account: 24_months    # 2ë…„ ë¯¸ì ‘ì† ì‹œ
    deleted_content: 30_days       # ì‚­ì œ í›„ 30ì¼ ë³´ê´€
    reported_content: 90_days      # ì‹ ê³  ì½˜í…ì¸  90ì¼ ë³´ê´€
```

### [í•„ìˆ˜] ìë™í™” ì •ì±… êµ¬í˜„
```python
# íŒŒì¼: backend/services/storage_lifecycle.py
class StorageLifecycleManager:
    def apply_retention_policy(self):
        """ë³´ê´€ ì •ì±… ìë™ ì ìš©"""
        
        policies = [
            {
                "name": "compress_old_images",
                "condition": "age > 3 months",
                "action": "recompress to 85% quality",
                "savings": "20%"
            },
            {
                "name": "archive_inactive",
                "condition": "last_accessed > 12 months",
                "action": "move to cold storage",
                "savings": "60%"
            },
            {
                "name": "delete_orphaned",
                "condition": "no parent record",
                "action": "delete after 7 days",
                "savings": "5%"
            }
        ]
        
        return policies
```

### [ì„ íƒ] ì‚¬ìš©ì ì„¤ì • ì˜µì…˜
```dart
// íŒŒì¼: lib/features/settings/presentation/widgets/storage_settings.dart
class StorageSettings extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return Column(
      children: [
        SwitchListTile(
          title: Text('ê³ í™”ì§ˆ ì´ë¯¸ì§€ ìœ ì§€'),
          subtitle: Text('ë” ë§ì€ ì €ì¥ ê³µê°„ ì‚¬ìš©'),
          value: ref.watch(highQualityProvider),
          onChanged: (value) {
            ref.read(highQualityProvider.notifier).state = value;
          },
        ),
        ListTile(
          title: Text('ì˜¤ë˜ëœ ì‚¬ì§„ ì••ì¶•'),
          subtitle: Text('3ê°œì›” ì´ìƒ ëœ ì‚¬ì§„ ìë™ ì••ì¶•'),
          trailing: Text('ê¸°ë³¸ ì„¤ì •'),
        ),
      ],
    );
  }
}
```

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ìš©ëŸ‰ ê³„ì‚° ë¡œì§ êµ¬í˜„
- [ ] ë¹„ìš© ì˜ˆì¸¡ ëŒ€ì‹œë³´ë“œ êµ¬ì¶•
- [ ] ë³´ê´€ ì •ì±… ìë™í™” ì„¤ì •
- [ ] ëª¨ë‹ˆí„°ë§ ì•Œë¦¼ êµ¬ì„±